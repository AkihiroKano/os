#!/bin/bash

# Создаем основную тестовую папку
test_dir="test_dir"
mkdir -p "$test_dir" || { echo "Ошибка: не удалось создать каталог $test_dir" >&2; exit 1; }

names=(
    "file with spaces.txt"
    "-r"
    "\\path\\file"
    "??.txt"
    "&.txt"
    "|file|.txt"
    "#abc.txt"
    "'d d'"
    "–file.txt"  # Дефис в начале
    "file\nname.txt"
    "subdir with spaces/file.txt"
    "subdir?/nested_file.log"
    "weird&dir/|file|"
)

for name in "${names[@]}"; do
    full_path="$test_dir/$name"
    
    if [[ "$name" == */* ]]; then
        parent_dir="$test_dir/$(dirname "$name")"
        mkdir -p "$parent_dir" || { echo "Ошибка создания $parent_dir" >&2; continue; }
    fi
    
    if [[ "$name" == *.* ]]; then
        touch "$full_path" || echo "Ошибка создания файла $full_path" >&2
    else
        mkdir -p "$full_path" || echo "Ошибка создания каталога $full_path" >&2
    fi
done

echo "Тестовая структура создана в папке $test_dir:"
tree "$test_dir"
